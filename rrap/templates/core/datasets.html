{% extends 'base.html' %}

{% load compress i18n static crispy_forms_tags %}

{% block title %}Datasets Â· Rapid Research for Agile Policymaking {% endblock %}

{% block content %}

<div class="page-head">
  <nav aria-label="breadcrumb" role="navigation">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="{% url 'core:home' %}">Home</a>
      </li>

      <li class="breadcrumb-item active">
        <a href="{% url 'core:datasets' %}"><i class="breadcrumb-icon fa fa-angle-left"></i>Datasets</a>
      </li>
    </ol>
  </nav>
</div>

<div class="main-content container-fluid">
  <div class="row table-filters-container">
    <div class="general-filters">
      <div class="general-filters-left">
        <h4 style="display:inline-flex" class="text-bold">All {{ datasets|length }} datasets </h4>
      </div>
      <div class="general-filters-right">
        <div class="btn-group">
          <button class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" type="button">Order by <span
              class="caret"></span></button>
          <div class="dropdown-menu dropdown-menu-right" role="menu"><a class="dropdown-item" href="#">Name
              Ascending</a><a class="dropdown-item" href="#">Name Descending</a><a class="dropdown-item"
              href="#">Dataset Count Descending</a>
            <div class="dropdown-divider"></div><a class="dropdown-item" href="#">Dataset Count Ascending</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-3 border-right">
      <h4 class="text-bold my-5">Filter datasets</h4>
      <form method="GET" action=".">
        <div class="card card-default card-contrast">
          <div class="card-header">Filter by location</div>
          <div class="card-body card-body-contrast" style="max-height:200px; overflow-y: scroll;">
            <div class="form-group row">
              <div class="col-12">
                {% for location in locations %}
                <div class="custom-control custom-checkbox">
                  <input class="custom-control-input" type="checkbox" id="{{ location.id }}" name="location"
                    value="{{ location.id }}">
                  <label class="custom-control-label" for="{{ location.id }}">{{ location.name }}</label>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
        <div class="card card-default card-contrast">
          <div class="card-header">Filter by organization</div>
          <div class="card-body card-body-contrast" style="max-height:200px; overflow-y: scroll;">
            <div class="form-group row">
              <div class="col-12">
                {% for org in organizations %}
                <div class="custom-control custom-checkbox">
                  <input class="custom-control-input" type="checkbox" id="{{ org.name }}" value="{{ org.name }}"
                    name="organization">
                  <label class="custom-control-label" for="{{ org.name }}">{{ org.title }}</label>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
        <div class="card card-default card-contrast">
          <div class="card-header">Filter by topic</div>
          <div class="card-body card-body-contrast" style="max-height:200px; overflow-y: scroll;">
            <div class="form-group row">
              <div class="col-12">

              </div>
            </div>
          </div>
        </div>
        <div class="card card-default card-contrast">
          <div class="card-header">Filter by format</div>
          <div class="card-body card-body-contrast" style="max-height:200px; overflow-y: scroll;">
            <div class="form-group row">
              <div class="col-12">

              </div>
            </div>
          </div>
        </div>
        <button type="submit" class="btn btn-block btn-lg btn-primary">Filter</button>
      </form>
    </div>
    <div class="col-md-9">
      <div class="card card-table">
        <div class="card-body">
          <div class="noSwipe">
            <table class="table table-striped table-hover be-table-responsive" id="dataTable">
              <thead>
                <tr>
                  <th style="width:10%;padding:0px;"></th>
                  <th style="width:10%;padding:0px;"></th>
                </tr>
              </thead>
              <tbody>
                {% for data in datasets %}
                <tr>
                  <td class="user-avatar cell-detail data-info">
                    <h4 class="text-bold mt-1"><a href="{% url 'core:single_dataset' data.uuid %}">{{ data.title }}</a>
                    </h4>
                    <h6><a
                        href="{% url 'organizations:organization' data.organization.name %}">{{ data.organization.title }}</a>
                    </h6>
                    <span class="cell-detail-description">Updated {{ data.last_updated|date:"d F, Y" }} | Dataset date:
                      {{ data.created|date:"d F, Y" }}</span>
                  </td>
                  <td class="cell-detail" data-set="{{ data.name }}">
                    <p>{{ data.summary|truncatechars:300 }}</p>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock content %}

{% block javascript %}
<script src="{% static 'lib/jquery-ui/jquery-ui.min.js' %}" type="text/javascript"></script>
<script src="{% static 'lib/select2/js/select2.min.js' %}" type="text/javascript"></script>
<script src="{% static 'lib/datatables/datatables.net/js/jquery.dataTables.js' %}" type="text/javascript"></script>
<script src="{% static 'lib/datatables/datatables.net-bs4/js/dataTables.bootstrap4.js' %}" type="text/javascript">
</script>
<script src="{% static 'lib/datatables/datatables.net-buttons/js/dataTables.buttons.min.js' %}" type="text/javascript">
</script>
<script src="{% static 'lib/datatables/datatables.net-buttons/js/buttons.flash.min.js' %}" type="text/javascript">
</script>
<script src="{% static 'lib/datatables/datatables.net-buttons/js/buttons.colVis.min.js' %}" type="text/javascript">
</script>
<script src="{% static 'lib/datatables/datatables.net-buttons/js/buttons.print.min.js' %}" type="text/javascript">
</script>
<script src="{% static 'lib/datatables/datatables.net-buttons/js/buttons.html5.min.js' %}" type="text/javascript">
</script>
<script src="{% static 'lib/datatables/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js' %}"
  type="text/javascript"></script>
<script src="{% static 'lib/datatables/datatables.net-responsive/js/dataTables.responsive.min.js' %}"
  type="text/javascript"></script>
<script src="{% static 'lib/datatables/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js' %}"
  type="text/javascript"></script>
<script type="text/javascript">
  $(document).ready(function () {
    var table = $('#dataTable').DataTable({
      pageLength: 20,
      dom: "<'row be-datatable-header'<'col-sm-6'l><'col-sm-6'f>>" +
        "<'row be-datatable-body'<'col-sm-12'tr>>" +
        "<'row be-datatable-footer'<'col-sm-5'i><'col-sm-7'p>>",
    });
  });

</script>
{% endblock %}
